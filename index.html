<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤ - ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap');
        
        body { 
            font-family: 'Sarabun', sans-serif;
        }
        
        .course-card {
            transition: all 0.3s ease;
        }
        
        .course-card:hover {
            transform: translateY(-4px);
        }
        
        .student-card {
            transition: all 0.2s ease;
        }
        
        .student-card:hover {
            transform: translateY(-2px);
        }
        
        .loading-spinner {
            border: 3px solid #f3f4f6;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .message {
            position: fixed;
            top: 1rem;
            right: 1rem;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 50;
        }
        
        .message.show {
            transform: translateX(0);
        }
        
        .photo-preview {
            width: 80px;
            height: 80px;
            border-radius: 0.5rem;
            object-fit: cover;
            border: 2px solid #e5e7eb;
        }
        
        .student-photo {
            width: 64px;
            height: 64px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .photo-placeholder {
            width: 64px;
            height: 64px;
            border-radius: 50%;
            background: #f3f4f6;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 3px solid white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-600 to-indigo-700 text-white shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                <h1 class="text-2xl sm:text-3xl font-bold flex items-center mb-2 sm:mb-0">
                    <i class="fas fa-graduation-cap mr-3"></i>
                    <div>
                        <div>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</div>
                        <div class="text-lg font-medium">‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£</div>
                    </div>
                </h1>
                <div class="flex items-center space-x-2">
                    <div id="connectionStatus" class="bg-blue-500 px-3 py-1 rounded-full text-sm">
                        <i class="fas fa-save mr-1"></i>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á
                    </div>
                    <div id="adminStatus" class="hidden bg-green-500 px-3 py-1 rounded-full text-sm">
                        <i class="fas fa-shield-alt mr-1"></i>‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
                    </div>
                    <button onclick="toggleAdminLogin()" id="adminBtn" 
                            class="bg-yellow-500 hover:bg-yellow-600 px-3 py-1 rounded text-sm transition-colors">
                        <i class="fas fa-key mr-1"></i>‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-4 py-8">
        <!-- Admin Login Modal -->
        <div id="adminLoginModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
            <div class="bg-white rounded-xl shadow-2xl p-6 m-4 max-w-md w-full">
                <h3 class="text-xl font-semibold text-gray-900 mb-4 text-center">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</h3>
                <form id="adminLoginForm">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
                        <input type="password" id="adminPassword" required 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                               placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
                    </div>
                    <div class="flex space-x-3">
                        <button type="button" onclick="closeAdminLogin()" 
                                class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded-lg transition-colors">
                            ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                        </button>
                        <button type="submit" 
                                class="flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors">
                            ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- GitHub Setup Modal -->
        <div id="githubSetupModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
            <div class="bg-white rounded-xl shadow-2xl p-6 m-4 max-w-2xl w-full max-h-96 overflow-y-auto">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-semibold text-gray-900">üöÄ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ GitHub Pages</h3>
                    <button onclick="closeGitHubSetup()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="space-y-4">
                    <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                        <h4 class="font-semibold text-green-800 mb-2">‚úÖ ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ç‡∏≠‡∏á GitHub Pages</h4>
                        <ul class="text-sm text-green-700 space-y-1">
                            <li>üÜì ‡∏ü‡∏£‡∏µ‡∏ï‡∏•‡∏≠‡∏î‡∏ä‡∏µ‡∏û - ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</li>
                            <li>üë• ‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô</li>
                            <li>üìù ‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</li>
                            <li>üîí ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ 100%</li>
                            <li>üåê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡∏ó‡∏µ‡πà</li>
                        </ul>
                    </div>
                    
                    <form id="githubSetupForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">GitHub Username *</label>
                            <input type="text" id="githubUsername" required 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                   placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ GitHub ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Repository Name *</label>
                            <input type="text" id="githubRepo" required value="student-management-system"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                   placeholder="‡∏ä‡∏∑‡πà‡∏≠ repository">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Personal Access Token *</label>
                            <input type="password" id="githubToken" required 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                   placeholder="GitHub Personal Access Token">
                            <p class="text-xs text-gray-600 mt-1">
                                <a href="https://github.com/settings/tokens" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:text-blue-800">
                                    ‡∏™‡∏£‡πâ‡∏≤‡∏á Token ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
                                </a> (‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå repo)
                            </p>
                        </div>
                        
                        <div class="flex space-x-3">
                            <button type="button" onclick="closeGitHubSetup()" 
                                    class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded-lg transition-colors">
                                ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                            </button>
                            <button type="submit" 
                                    class="flex-1 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                                ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ GitHub
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Cloud Options Modal -->
        <div id="cloudOptionsModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
            <div class="bg-white rounded-xl shadow-2xl p-6 m-4 max-w-4xl w-full max-h-96 overflow-y-auto">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-semibold text-gray-900">üåü ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå‡∏ü‡∏£‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h3>
                    <button onclick="closeCloudOptions()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-orange-50 p-4 rounded-lg border border-orange-200">
                        <h4 class="font-semibold text-orange-800 mb-2">üî• Firebase Firestore</h4>
                        <ul class="text-sm text-orange-700 space-y-1">
                            <li>‚úÖ 1GB ‡∏ü‡∏£‡∏µ</li>
                            <li>‚úÖ Real-time sync</li>
                            <li>‚úÖ ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢</li>
                            <li>‚úÖ Google Account</li>
                        </ul>
                        <a href="https://firebase.google.com/" target="_blank" rel="noopener noreferrer" 
                           class="inline-block mt-2 bg-orange-600 text-white px-3 py-1 rounded text-sm hover:bg-orange-700">
                            ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
                        </a>
                    </div>
                    
                    <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                        <h4 class="font-semibold text-green-800 mb-2">‚ö° Supabase</h4>
                        <ul class="text-sm text-green-700 space-y-1">
                            <li>‚úÖ 500MB ‡∏ü‡∏£‡∏µ</li>
                            <li>‚úÖ PostgreSQL</li>
                            <li>‚úÖ Real-time</li>
                            <li>‚úÖ API ‡∏á‡πà‡∏≤‡∏¢</li>
                        </ul>
                        <a href="https://supabase.com/" target="_blank" rel="noopener noreferrer" 
                           class="inline-block mt-2 bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700">
                            ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
                        </a>
                    </div>
                    
                    <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                        <h4 class="font-semibold text-blue-800 mb-2">üìÅ GitHub Pages</h4>
                        <ul class="text-sm text-blue-700 space-y-1">
                            <li>‚úÖ ‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ç‡∏ô‡∏≤‡∏î</li>
                            <li>‚úÖ Version control</li>
                            <li>‚úÖ JSON files</li>
                            <li>‚úÖ ‡∏ü‡∏£‡∏µ‡∏ï‡∏•‡∏≠‡∏î‡∏ä‡∏µ‡∏û</li>
                        </ul>
                        <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer" 
                           class="inline-block mt-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                            ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
                        </a>
                    </div>
                    
                    <div class="bg-purple-50 p-4 rounded-lg border border-purple-200">
                        <h4 class="font-semibold text-purple-800 mb-2">‚ö° Netlify Functions</h4>
                        <ul class="text-sm text-purple-700 space-y-1">
                            <li>‚úÖ 125k requests/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</li>
                            <li>‚úÖ Serverless</li>
                            <li>‚úÖ Auto deploy</li>
                            <li>‚úÖ CDN ‡∏ü‡∏£‡∏µ</li>
                        </ul>
                        <a href="https://www.netlify.com/" target="_blank" rel="noopener noreferrer" 
                           class="inline-block mt-2 bg-purple-600 text-white px-3 py-1 rounded text-sm hover:bg-purple-700">
                            ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
                        </a>
                    </div>
                </div>
                
                <div class="mt-6 bg-gray-50 p-4 rounded-lg">
                    <h4 class="font-semibold text-gray-800 mb-2">üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</h4>
                    <p class="text-sm text-gray-700">
                        ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ <strong>Firebase</strong> ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î 
                        ‡∏´‡∏£‡∏∑‡∏≠ <strong>GitHub Pages</strong> ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ü‡∏£‡∏µ‡∏ï‡∏•‡∏≠‡∏î‡∏ä‡∏µ‡∏û
                    </p>
                </div>
            </div>
        </div>

        <!-- Backup Manager Modal -->
        <div id="backupManagerModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
            <div class="bg-white rounded-xl shadow-2xl p-6 m-4 max-w-2xl w-full max-h-96 overflow-y-auto">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-semibold text-gray-900">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏£‡∏≠‡∏á</h3>
                    <button onclick="closeBackupManager()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="space-y-4">
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-blue-800 mb-2">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏£‡∏≠‡∏á</h4>
                        <div id="backupStatus" class="text-sm text-blue-700">
                            ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...
                        </div>
                    </div>
                    
                    <div class="bg-green-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-green-800 mb-2">‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</h4>
                        <div class="flex flex-wrap gap-2">
                            <button onclick="createManualBackup()" 
                                    class="bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded text-sm transition-colors">
                                <i class="fas fa-save mr-1"></i>‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ
                            </button>
                            <button onclick="downloadBackup()" 
                                    class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded text-sm transition-colors">
                                <i class="fas fa-download mr-1"></i>‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡∏£‡∏≠‡∏á
                            </button>
                            <label for="restoreBackup" class="bg-orange-600 hover:bg-orange-700 text-white px-3 py-2 rounded text-sm transition-colors cursor-pointer">
                                <i class="fas fa-upload mr-1"></i>‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå
                                <input type="file" id="restoreBackup" accept=".json" class="hidden">
                            </label>
                        </div>
                    </div>
                    
                    <div class="bg-yellow-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-yellow-800 mb-2">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</h4>
                        <div id="backupList" class="space-y-2 max-h-40 overflow-y-auto">
                            <!-- Backup list will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Search Section -->
        <div id="searchSection" class="hidden bg-white rounded-xl shadow-lg p-6 mb-8 border-l-4 border-purple-500">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6">
                <div class="flex items-center mb-4 sm:mb-0">
                    <div class="bg-purple-100 p-3 rounded-full mr-4">
                        <i class="fas fa-search text-purple-600 text-xl"></i>
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-purple-800">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</h2>
                        <p class="text-sm text-purple-600">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£</p>
                    </div>
                </div>
                <button onclick="backToCourseSelection()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-arrow-left mr-2"></i>‡∏Å‡∏•‡∏±‡∏ö
                </button>
            </div>
            <div class="mb-6">
                <div class="relative">
                    <input type="text" id="searchInput" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á, ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô, ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£..." 
                           class="w-full px-4 py-3 pl-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-lg">
                    <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                </div>
                <div class="flex flex-wrap gap-2 mt-3">
                    <button onclick="filterByCourse('')" class="filter-btn bg-purple-600 text-white px-3 py-1 rounded-full text-sm transition-colors">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                    <button onclick="filterByCourse('‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£')" class="filter-btn bg-gray-200 text-gray-700 px-3 py-1 rounded-full text-sm hover:bg-purple-100 transition-colors">‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£</button>
                    <button onclick="filterByCourse('‡∏ô‡∏≤‡∏¢‡∏ó‡∏´‡∏≤‡∏£‡∏≠‡∏≤‡∏ß‡∏∏‡πÇ‡∏™ ‡∏ö‡∏Å.‡∏ó‡∏ó.')" class="filter-btn bg-gray-200 text-gray-700 px-3 py-1 rounded-full text-sm hover:bg-purple-100 transition-colors">‡∏ô‡∏≤‡∏¢‡∏ó‡∏´‡∏≤‡∏£‡∏≠‡∏≤‡∏ß‡∏∏‡πÇ‡∏™ ‡∏ö‡∏Å.‡∏ó‡∏ó.</button>
                    <button onclick="filterByCourse('‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡πà‡∏ß‡∏°')" class="filter-btn bg-gray-200 text-gray-700 px-3 py-1 rounded-full text-sm hover:bg-purple-100 transition-colors">‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡πà‡∏ß‡∏°</button>
                </div>
            </div>
            <div id="searchResults" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <!-- Search results will be displayed here -->
            </div>
        </div>

        <!-- Course Selection -->
        <div id="courseSelection" class="bg-white rounded-xl shadow-lg p-6 mb-8">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4 sm:mb-0">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</h2>
                <button onclick="showSearchSection()" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-search mr-2"></i>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤
                </button>
            </div>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <div onclick="selectCourse('‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£')" 
                     class="course-card bg-gradient-to-br from-blue-500 to-blue-600 text-white p-6 rounded-xl cursor-pointer shadow-lg hover:shadow-xl">
                    <div class="text-center">
                        <i class="fas fa-star text-4xl mb-4"></i>
                        <h3 class="text-xl font-semibold mb-2">‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£</h3>
                        <p class="text-blue-100" id="count-‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£">2 ‡∏Ñ‡∏ô</p>
                    </div>
                </div>
                <div onclick="selectCourse('‡∏ô‡∏≤‡∏¢‡∏ó‡∏´‡∏≤‡∏£‡∏≠‡∏≤‡∏ß‡∏∏‡πÇ‡∏™ ‡∏ö‡∏Å.‡∏ó‡∏ó.')" 
                     class="course-card bg-gradient-to-br from-green-500 to-green-600 text-white p-6 rounded-xl cursor-pointer shadow-lg hover:shadow-xl">
                    <div class="text-center">
                        <i class="fas fa-medal text-4xl mb-4"></i>
                        <h3 class="text-xl font-semibold mb-2">‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ô‡∏≤‡∏¢‡∏ó‡∏´‡∏≤‡∏£‡∏≠‡∏≤‡∏ß‡∏∏‡πÇ‡∏™ ‡∏ö‡∏Å.‡∏ó‡∏ó.</h3>
                        <p class="text-green-100" id="count-‡∏ô‡∏≤‡∏¢‡∏ó‡∏´‡∏≤‡∏£‡∏≠‡∏≤‡∏ß‡∏∏‡πÇ‡∏™ ‡∏ö‡∏Å.‡∏ó‡∏ó.">1 ‡∏Ñ‡∏ô</p>
                    </div>
                </div>
                <div onclick="selectCourse('‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡πà‡∏ß‡∏°')" 
                     class="course-card bg-gradient-to-br from-purple-500 to-purple-600 text-white p-6 rounded-xl cursor-pointer shadow-lg hover:shadow-xl sm:col-span-2 lg:col-span-1">
                    <div class="text-center">
                        <i class="fas fa-handshake text-4xl mb-4"></i>
                        <h3 class="text-xl font-semibold mb-2">‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡πà‡∏ß‡∏°</h3>
                        <p class="text-purple-100" id="count-‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡πà‡∏ß‡∏°">1 ‡∏Ñ‡∏ô</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Panel -->
        <div id="adminPanel" class="hidden bg-white rounded-xl shadow-lg p-6 mb-8 border-l-4 border-blue-500">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6">
                <h2 class="text-2xl font-bold text-blue-800 mb-4 sm:mb-0">
                    <i class="fas fa-shield-alt mr-3 text-blue-600"></i>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
                </h2>
                <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3">
                    <button onclick="toggleAddForm()" id="toggleAddBtn" 
                            class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-plus mr-2"></i>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÉ‡∏´‡∏°‡πà
                    </button>
                    <button onclick="exportToCSV()" 
                            class="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-download mr-2"></i>‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CSV
                    </button>
                    <label for="importCSV" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg transition-colors cursor-pointer">
                        <i class="fas fa-upload mr-2"></i>‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CSV
                        <input type="file" id="importCSV" accept=".csv" class="hidden">
                    </label>
                    <button onclick="showBackupManager()" 
                            class="bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-history mr-2"></i>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏£‡∏≠‡∏á
                    </button>
                    <button onclick="showGitHubSetup()" 
                            class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                        <i class="fab fa-github mr-2"></i>GitHub Pages
                    </button>
                    <button onclick="showCloudOptions()" 
                            class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-cloud mr-2"></i>‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∑‡πà‡∏ô
                    </button>
                    <button onclick="logoutAdmin()" 
                            class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-sign-out-alt mr-2"></i>‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
                    </button>
                </div>
            </div>
            
            <!-- Add Student Form -->
            <div id="addStudentForm" class="hidden border-t-2 border-green-200 pt-6 bg-green-50 rounded-lg p-6">
                <h3 class="text-xl font-bold text-green-800 mb-4">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÉ‡∏´‡∏°‡πà</h3>
                <form id="studentForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£ *</label>
                        <select id="studentCourse" required 
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£</option>
                            <option value="‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£">‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£</option>
                            <option value="‡∏ô‡∏≤‡∏¢‡∏ó‡∏´‡∏≤‡∏£‡∏≠‡∏≤‡∏ß‡∏∏‡πÇ‡∏™ ‡∏ö‡∏Å.‡∏ó‡∏ó.">‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ô‡∏≤‡∏¢‡∏ó‡∏´‡∏≤‡∏£‡∏≠‡∏≤‡∏ß‡∏∏‡πÇ‡∏™ ‡∏ö‡∏Å.‡∏ó‡∏ó.</option>
                            <option value="‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡πà‡∏ß‡∏°">‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡πà‡∏ß‡∏°</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á *</label>
                        <input type="text" id="fullName" required 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß</label>
                        <input type="file" id="photo" accept="image/*" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <div id="photoPreview" class="mt-2"></div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</label>
                        <input type="text" id="nickname" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
                        <input type="text" id="position" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label>
                        <input type="tel" id="phone" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</label>
                        <input type="date" id="birthDate" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div class="md:col-span-2 flex space-x-3">
                        <button type="button" onclick="toggleAddForm()" 
                                class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-6 py-2 rounded-lg transition-colors">
                            ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                        </button>
                        <button type="submit" id="submitBtn" 
                                class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-2 rounded-lg transition-colors flex items-center">
                            <span id="submitText">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
                            <div id="submitSpinner" class="loading-spinner ml-2 hidden"></div>
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Students List -->
        <div id="studentsSection" class="hidden bg-white rounded-xl shadow-lg p-6 border-l-4 border-indigo-500">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6">
                <div>
                    <h2 class="text-2xl font-bold text-indigo-800" id="studentsTitle">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</h2>
                    <p class="text-sm text-indigo-600">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÉ‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</p>
                </div>
                <button onclick="backToCourseSelection()" 
                        class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-arrow-left mr-2"></i>‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£
                </button>
            </div>
            <div id="studentsList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <!-- Students will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Success Message -->
    <div id="successMessage" class="message bg-green-500 text-white">
        <i class="fas fa-check-circle mr-2"></i>
        <span id="successText">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</span>
    </div>

    <!-- Error Message -->
    <div id="errorMessage" class="message bg-red-500 text-white">
        <i class="fas fa-exclamation-circle mr-2"></i>
        <span id="errorText">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î!</span>
    </div>

    <script>
        // GitHub Pages system - free forever with version control
        // Data stored in JSON files in the repository
        const GITHUB_CONFIG = {
            username: 'YOUR_GITHUB_USERNAME', // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ GitHub ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
            repository: 'student-management-system', // ‡∏ä‡∏∑‡πà‡∏≠ repository
            branch: 'main',
            dataFile: 'data/students.json'
        };
        
        const STORAGE_KEY = 'student_management_system';
        const BACKUP_PREFIX = 'backup_student_data';
        
        // Sheet names for each course - using simple sheet names
        const SHEET_NAMES = {
            '‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£': 'Sheet1',
            '‡∏ô‡∏≤‡∏¢‡∏ó‡∏´‡∏≤‡∏£‡∏≠‡∏≤‡∏ß‡∏∏‡πÇ‡∏™ ‡∏ö‡∏Å.‡∏ó‡∏ó.': 'Sheet2', 
            '‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡πà‡∏ß‡∏°': 'Sheet3'
        };
        const ADMIN_PASSWORD = 'admin123';
        let currentCourse = '';
        let isAdminLoggedIn = false;
        let allStudentsData = [];
        let filteredStudents = [];
        let currentSearchFilter = '';
        let isOnlineMode = false;
        let syncInterval = null;
        let lastSyncTime = null;
        let autoBackupInterval = null;

        // Demo data as fallback
        let studentsData = {
            '‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£': [
                {
                    id: 'demo1',
                    fullName: '‡∏û‡∏±‡∏ô‡πÄ‡∏≠‡∏Å ‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ',
                    nickname: '‡∏ä‡∏≤‡∏¢',
                    position: '‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ú‡∏ô‡∏Å',
                    phone: '081-234-5678',
                    birthDate: '1985-05-15',
                    photoBase64: '',
                    course: '‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£'
                },
                {
                    id: 'demo2',
                    fullName: '‡∏û‡∏±‡∏ô‡πÇ‡∏ó ‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á ‡∏£‡∏±‡∏Å‡∏ä‡∏≤‡∏ï‡∏¥',
                    nickname: '‡∏´‡∏ç‡∏¥‡∏á',
                    position: '‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå',
                    phone: '082-345-6789',
                    birthDate: '1987-08-22',
                    photoBase64: '',
                    course: '‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£'
                }
            ],
            '‡∏ô‡∏≤‡∏¢‡∏ó‡∏´‡∏≤‡∏£‡∏≠‡∏≤‡∏ß‡∏∏‡πÇ‡∏™ ‡∏ö‡∏Å.‡∏ó‡∏ó.': [
                {
                    id: 'demo3',
                    fullName: '‡∏à‡πà‡∏≤‡πÄ‡∏≠‡∏Å ‡∏ß‡∏¥‡∏ä‡∏±‡∏¢ ‡∏Å‡∏•‡πâ‡∏≤‡∏´‡∏≤‡∏ç',
                    nickname: '‡∏ß‡∏¥‡∏ä‡∏±‡∏¢',
                    position: '‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏ô‡πà‡∏ß‡∏¢',
                    phone: '083-456-7890',
                    birthDate: '1980-12-10',
                    photoBase64: '',
                    course: '‡∏ô‡∏≤‡∏¢‡∏ó‡∏´‡∏≤‡∏£‡∏≠‡∏≤‡∏ß‡∏∏‡πÇ‡∏™ ‡∏ö‡∏Å.‡∏ó‡∏ó.'
                }
            ],
            '‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡πà‡∏ß‡∏°': [
                {
                    id: 'demo4',
                    fullName: '‡∏û‡∏±‡∏ô‡πÄ‡∏≠‡∏Å ‡∏™‡∏°‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡πÄ‡∏Å‡πà‡∏á‡∏Å‡∏≤‡∏à',
                    nickname: '‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå',
                    position: '‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤',
                    phone: '084-567-8901',
                    birthDate: '1983-03-18',
                    photoBase64: '',
                    course: '‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡πà‡∏ß‡∏°'
                }
            ]
        };

        // GitHub Pages system with JSON file storage
        // üåü GITHUB PAGES ADVANTAGES:
        // 1. ‡∏ü‡∏£‡∏µ‡∏ï‡∏•‡∏≠‡∏î‡∏ä‡∏µ‡∏û - ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢
        // 2. Version Control - ‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        // 3. Multi-user - ‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ
        // 4. Backup ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ 100%
        
        let githubToken = localStorage.getItem('github_token');
        let isGitHubMode = false;
        
        function initializeCloudStorage() {
            // Check if GitHub token is available
            if (githubToken && GITHUB_CONFIG.username !== 'YOUR_GITHUB_USERNAME') {
                isGitHubMode = true;
                console.log('üåü GitHub Pages mode activated - unlimited free storage!');
                return true;
            } else {
                console.log('üì± Local storage mode - upgrade to GitHub Pages for multi-user access');
                return false;
            }
        }
        
        // GitHub API functions
        async function getGitHubFile(path) {
            if (!githubToken) throw new Error('GitHub token required');
            
            const url = `https://api.github.com/repos/${GITHUB_CONFIG.username}/${GITHUB_CONFIG.repository}/contents/${path}`;
            
            try {
                const response = await fetch(url, {
                    headers: {
                        'Authorization': `token ${githubToken}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (response.status === 404) {
                    return null; // File doesn't exist yet
                }
                
                if (!response.ok) {
                    throw new Error(`GitHub API error: ${response.status}`);
                }
                
                const data = await response.json();
                const content = atob(data.content.replace(/\s/g, ''));
                return {
                    content: JSON.parse(content),
                    sha: data.sha
                };
            } catch (error) {
                console.error('GitHub read error:', error);
                throw error;
            }
        }
        
        async function saveGitHubFile(path, data, sha = null) {
            if (!githubToken) throw new Error('GitHub token required');
            
            const url = `https://api.github.com/repos/${GITHUB_CONFIG.username}/${GITHUB_CONFIG.repository}/contents/${path}`;
            const content = btoa(JSON.stringify(data, null, 2));
            
            const payload = {
                message: `Update student data - ${new Date().toISOString()}`,
                content: content,
                branch: GITHUB_CONFIG.branch
            };
            
            if (sha) {
                payload.sha = sha;
            }
            
            try {
                const response = await fetch(url, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${githubToken}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });
                
                if (!response.ok) {
                    throw new Error(`GitHub API error: ${response.status}`);
                }
                
                return await response.json();
            } catch (error) {
                console.error('GitHub save error:', error);
                throw error;
            }
        }
        
        async function syncWithGitHub() {
            if (!isGitHubMode) return false;
            
            try {
                // Get current data from GitHub
                const githubData = await getGitHubFile(GITHUB_CONFIG.dataFile);
                
                if (githubData) {
                    // Merge with local data
                    const remoteData = githubData.content;
                    const hasLocalChanges = JSON.stringify(studentsData) !== JSON.stringify(remoteData);
                    
                    if (hasLocalChanges) {
                        // Simple merge strategy - use most recent data
                        studentsData = remoteData;
                        saveToLocalStorage();
                        lastSyncTime = new Date();
                        return true;
                    }
                }
                
                return false;
            } catch (error) {
                console.error('GitHub sync error:', error);
                return false;
            }
        }
        
        async function pushToGitHub() {
            if (!isGitHubMode) return false;
            
            try {
                const existingFile = await getGitHubFile(GITHUB_CONFIG.dataFile);
                const sha = existingFile ? existingFile.sha : null;
                
                await saveGitHubFile(GITHUB_CONFIG.dataFile, studentsData, sha);
                lastSyncTime = new Date();
                return true;
            } catch (error) {
                console.error('GitHub push error:', error);
                throw error;
            }
        }

        function parseSheetData(values, course) {
            const students = [];

            // Parse each row (no header row expected)
            for (let i = 0; i < values.length; i++) {
                const row = values[i];
                if (row.length >= 1 && row[0]) { // At least name is required
                    const student = {
                        id: generateId(), // Generate new ID for each sync
                        course: course,
                        fullName: row[0] || '',
                        nickname: row[1] || '',
                        position: row[2] || '',
                        phone: row[3] || '',
                        birthDate: row[4] || '',
                        photoBase64: row[5] || ''
                    };

                    students.push(student);
                }
            }

            return students;
        }



        function mergeStudentsData(sheetsData) {
            // Create a map of existing local students by ID
            const localStudentsMap = new Map();
            Object.keys(studentsData).forEach(course => {
                studentsData[course].forEach(student => {
                    localStudentsMap.set(student.id, student);
                });
            });

            // Merge sheets data with local data
            const mergedData = {
                '‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£': [],
                '‡∏ô‡∏≤‡∏¢‡∏ó‡∏´‡∏≤‡∏£‡∏≠‡∏≤‡∏ß‡∏∏‡πÇ‡∏™ ‡∏ö‡∏Å.‡∏ó‡∏ó.': [],
                '‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡πà‡∏ß‡∏°': []
            };

            // Add sheets data (prioritize sheets data for conflicts)
            Object.keys(sheetsData).forEach(course => {
                sheetsData[course].forEach(student => {
                    mergedData[course].push(student);
                    localStudentsMap.delete(student.id); // Remove from local map
                });
            });

            // Add remaining local-only students
            localStudentsMap.forEach(student => {
                if (mergedData[student.course]) {
                    mergedData[student.course].push(student);
                }
            });

            studentsData = mergedData;
            saveToLocalStorage();
        }

        // Local storage functions with backup
        function saveToLocalStorage() {
            try {
                const timestamp = new Date().toISOString();
                localStorage.setItem('studentsData', JSON.stringify(studentsData));
                localStorage.setItem('lastSaved', timestamp);
                
                // Create backup
                createAutoBackup();
            } catch (error) {
                console.error('Local storage save error:', error);
            }
        }

        function loadFromLocalStorage() {
            try {
                const saved = localStorage.getItem('studentsData');
                if (saved) {
                    studentsData = JSON.parse(saved);
                }
            } catch (error) {
                console.error('Local storage load error:', error);
                // Try to restore from backup
                restoreFromBackup();
            }
        }

        // Auto backup system
        function createAutoBackup() {
            try {
                const timestamp = new Date().toISOString();
                const backupKey = `backup_${timestamp.split('T')[0]}`; // Daily backup
                const backupData = {
                    timestamp: timestamp,
                    data: studentsData
                };
                
                localStorage.setItem(backupKey, JSON.stringify(backupData));
                
                // Keep only last 7 days of backups
                cleanOldBackups();
            } catch (error) {
                console.error('Auto backup error:', error);
            }
        }

        function cleanOldBackups() {
            try {
                const keys = Object.keys(localStorage);
                const backupKeys = keys.filter(key => key.startsWith('backup_'));
                
                // Sort by date and keep only last 7
                backupKeys.sort().reverse();
                
                for (let i = 7; i < backupKeys.length; i++) {
                    localStorage.removeItem(backupKeys[i]);
                }
            } catch (error) {
                console.error('Cleanup backups error:', error);
            }
        }

        function restoreFromBackup() {
            try {
                const keys = Object.keys(localStorage);
                const backupKeys = keys.filter(key => key.startsWith('backup_'));
                
                if (backupKeys.length > 0) {
                    // Get most recent backup
                    backupKeys.sort().reverse();
                    const latestBackup = localStorage.getItem(backupKeys[0]);
                    
                    if (latestBackup) {
                        const backupData = JSON.parse(latestBackup);
                        studentsData = backupData.data;
                        showMessage('success', '‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                        return true;
                    }
                }
            } catch (error) {
                console.error('Restore from backup error:', error);
            }
            return false;
        }

        // Start auto sync and backup
        function startAutoSync() {
            // Sync every 30 seconds
            syncInterval = setInterval(async () => {
                if (isOnlineMode) {
                    await syncWithGoogleSheets();
                }
            }, 30000);

            // Auto backup every 5 minutes
            autoBackupInterval = setInterval(() => {
                createAutoBackup();
            }, 300000);
        }

        function stopAutoSync() {
            if (syncInterval) {
                clearInterval(syncInterval);
                syncInterval = null;
            }
            if (autoBackupInterval) {
                clearInterval(autoBackupInterval);
                autoBackupInterval = null;
            }
        }

        async function createStudent(studentData) {
            try {
                // Add to local data
                const newStudent = {
                    id: generateId(),
                    ...studentData
                };
                
                if (!studentsData[studentData.course]) {
                    studentsData[studentData.course] = [];
                }
                
                studentsData[studentData.course].push(newStudent);
                saveToLocalStorage();
                
                // Sync to GitHub if enabled
                if (isGitHubMode) {
                    try {
                        await pushToGitHub();
                        return { 
                            success: true, 
                            message: 'üéâ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏ã‡∏¥‡∏á‡∏Ñ‡πå GitHub ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 
                            online: true 
                        };
                    } catch (error) {
                        console.error('GitHub sync error:', error);
                        return { 
                            success: true, 
                            message: 'üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡∏ã‡∏¥‡∏á‡∏Ñ‡πå GitHub ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß)', 
                            local: true 
                        };
                    }
                } else {
                    return { 
                        success: true, 
                        message: 'üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 
                        local: true 
                    };
                }
            } catch (error) {
                console.error('Create student error:', error);
                return { success: false, error: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•' };
            }
        }

        async function readStudents(course) {
            try {
                return {
                    success: true,
                    data: studentsData[course] || [],
                    offline: true
                };
            } catch (error) {
                console.error('Read students error:', error);
                return {
                    success: false,
                    error: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'
                };
            }
        }

        async function deleteStudent(studentId, course) {
            try {
                const studentIndex = studentsData[course]?.findIndex(s => s.id === studentId);
                if (studentIndex !== -1) {
                    studentsData[course].splice(studentIndex, 1);
                    saveToLocalStorage();
                    
                    return { 
                        success: true, 
                        message: '‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üóëÔ∏è', 
                        local: true 
                    };
                }
                return { success: false, error: '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö' };
            } catch (error) {
                console.error('Delete student error:', error);
                return { success: false, error: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•' };
            }
        }

        // Utility functions
        function generateId() {
            return 'student_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        // Advanced image compression system
        function compressImage(file, maxWidth = 400, maxHeight = 400, quality = 0.8) {
            return new Promise((resolve, reject) => {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const img = new Image();
                
                img.onload = () => {
                    try {
                        let { width, height } = img;
                        
                        // Calculate new dimensions maintaining aspect ratio
                        const aspectRatio = width / height;
                        
                        if (width > maxWidth || height > maxHeight) {
                            if (width > height) {
                                width = maxWidth;
                                height = width / aspectRatio;
                                if (height > maxHeight) {
                                    height = maxHeight;
                                    width = height * aspectRatio;
                                }
                            } else {
                                height = maxHeight;
                                width = height * aspectRatio;
                                if (width > maxWidth) {
                                    width = maxWidth;
                                    height = width / aspectRatio;
                                }
                            }
                        }
                        
                        canvas.width = width;
                        canvas.height = height;
                        
                        // Enable image smoothing for better quality
                        ctx.imageSmoothingEnabled = true;
                        ctx.imageSmoothingQuality = 'high';
                        
                        // Draw with white background for transparency handling
                        ctx.fillStyle = '#FFFFFF';
                        ctx.fillRect(0, 0, width, height);
                        
                        // Draw and compress
                        ctx.drawImage(img, 0, 0, width, height);
                        
                        // Try different compression levels based on file size
                        canvas.toBlob((blob) => {
                            if (blob) {
                                // If still too large, compress more
                                if (blob.size > 500000 && quality > 0.3) { // 500KB limit
                                    compressImage(file, maxWidth * 0.8, maxHeight * 0.8, quality * 0.7)
                                        .then(resolve)
                                        .catch(reject);
                                } else {
                                    resolve(blob);
                                }
                            } else {
                                reject(new Error('Failed to compress image'));
                            }
                        }, 'image/jpeg', quality);
                        
                    } catch (error) {
                        reject(error);
                    }
                };
                
                img.onerror = () => reject(new Error('Failed to load image'));
                img.src = URL.createObjectURL(file);
            });
        }

        // Progressive image loading
        function createProgressiveImage(base64Data) {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => {
                    // Create a low-quality preview first
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    
                    canvas.width = 64;
                    canvas.height = 64;
                    
                    ctx.drawImage(img, 0, 0, 64, 64);
                    const lowQuality = canvas.toDataURL('image/jpeg', 0.3);
                    
                    resolve({
                        lowQuality: lowQuality,
                        highQuality: base64Data
                    });
                };
                img.src = base64Data;
            });
        }

        // Image validation and processing
        function validateAndProcessImage(file) {
            return new Promise((resolve, reject) => {
                // Validate file type
                const validTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/webp'];
                if (!validTypes.includes(file.type)) {
                    reject(new Error('‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÑ‡∏ü‡∏•‡πå JPG, PNG ‡πÅ‡∏•‡∏∞ WebP ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô'));
                    return;
                }

                // Validate file size (max 10MB)
                if (file.size > 10 * 1024 * 1024) {
                    reject(new Error('‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 10MB'));
                    return;
                }

                // Check image dimensions
                const img = new Image();
                img.onload = async () => {
                    try {
                        // Warn if image is too small
                        if (img.width < 100 || img.height < 100) {
                            if (!confirm('‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å ‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏î‡∏µ ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                                reject(new Error('‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û'));
                                return;
                            }
                        }

                        // Compress image
                        const compressedBlob = await compressImage(file);
                        const base64 = await fileToBase64(compressedBlob);
                        
                        resolve({
                            base64: base64,
                            originalSize: file.size,
                            compressedSize: compressedBlob.size,
                            dimensions: { width: img.width, height: img.height }
                        });
                    } catch (error) {
                        reject(error);
                    }
                };
                
                img.onerror = () => reject(new Error('‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢'));
                img.src = URL.createObjectURL(file);
            });
        }

        function showMessage(type, message) {
            const messageEl = document.getElementById(type === 'success' ? 'successMessage' : 'errorMessage');
            const textEl = document.getElementById(type === 'success' ? 'successText' : 'errorText');
            
            textEl.textContent = message;
            messageEl.classList.add('show');
            
            setTimeout(() => {
                messageEl.classList.remove('show');
            }, 3000);
        }

        function updateConnectionStatus(mode) {
            const statusEl = document.getElementById('connectionStatus');
            
            if (mode === 'github') {
                statusEl.className = 'bg-green-500 px-3 py-1 rounded-full text-sm';
                statusEl.innerHTML = '<i class="fab fa-github mr-1"></i>GitHub Pages';
                isOnlineMode = true;
            } else if (mode === 'local') {
                statusEl.className = 'bg-blue-500 px-3 py-1 rounded-full text-sm';
                statusEl.innerHTML = '<i class="fas fa-save mr-1"></i>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á';
                isOnlineMode = false;
            }
            
            // Update last sync time display
            if (isOnlineMode && lastSyncTime) {
                const timeStr = lastSyncTime.toLocaleTimeString('th-TH');
                statusEl.title = `‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${timeStr}`;
            }
        }

        function formatDate(dateString) {
            if (!dateString) return '';
            const date = new Date(dateString);
            return date.toLocaleDateString('th-TH', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        // Admin functions
        function toggleAdminLogin() {
            if (isAdminLoggedIn) {
                logoutAdmin();
            } else {
                document.getElementById('adminLoginModal').classList.remove('hidden');
                document.getElementById('adminPassword').focus();
            }
        }

        function closeAdminLogin() {
            document.getElementById('adminLoginModal').classList.add('hidden');
            document.getElementById('adminPassword').value = '';
        }

        function loginAdmin(password) {
            if (password === ADMIN_PASSWORD) {
                isAdminLoggedIn = true;
                document.getElementById('adminStatus').classList.remove('hidden');
                document.getElementById('adminPanel').classList.remove('hidden');
                document.getElementById('adminBtn').innerHTML = '<i class="fas fa-sign-out-alt mr-1"></i>‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö';
                document.getElementById('adminBtn').className = 'bg-red-500 hover:bg-red-600 px-3 py-1 rounded text-sm transition-colors';
                closeAdminLogin();
                showMessage('success', '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                return true;
            } else {
                showMessage('error', '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!');
                return false;
            }
        }

        function logoutAdmin() {
            isAdminLoggedIn = false;
            document.getElementById('adminStatus').classList.add('hidden');
            document.getElementById('adminPanel').classList.add('hidden');
            document.getElementById('addStudentForm').classList.add('hidden');
            document.getElementById('adminBtn').innerHTML = '<i class="fas fa-key mr-1"></i>‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô';
            document.getElementById('adminBtn').className = 'bg-yellow-500 hover:bg-yellow-600 px-3 py-1 rounded text-sm transition-colors';
            document.getElementById('toggleAddBtn').innerHTML = '<i class="fas fa-plus mr-2"></i>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÉ‡∏´‡∏°‡πà';
            showMessage('success', '‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß');
        }

        function toggleAddForm() {
            if (!isAdminLoggedIn) {
                showMessage('error', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô');
                return;
            }
            const form = document.getElementById('addStudentForm');
            const btn = document.getElementById('toggleAddBtn');
            
            if (form.classList.contains('hidden')) {
                form.classList.remove('hidden');
                btn.innerHTML = '<i class="fas fa-minus mr-2"></i>‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å';
                btn.className = 'bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors';
            } else {
                form.classList.add('hidden');
                btn.innerHTML = '<i class="fas fa-plus mr-2"></i>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÉ‡∏´‡∏°‡πà';
                btn.className = 'bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors';
                document.getElementById('studentForm').reset();
                document.getElementById('photoPreview').innerHTML = '';
            }
        }

        // Course selection
        function selectCourse(course) {
            currentCourse = course;
            document.getElementById('studentsTitle').textContent = `‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤ - ${course}`;
            document.getElementById('studentsSection').classList.remove('hidden');
            document.getElementById('courseSelection').classList.add('hidden');
            document.getElementById('searchSection').classList.add('hidden');
            loadStudents();
        }

        function backToCourseSelection() {
            currentCourse = '';
            document.getElementById('studentsSection').classList.add('hidden');
            document.getElementById('searchSection').classList.add('hidden');
            document.getElementById('courseSelection').classList.remove('hidden');
        }

        function showSearchSection() {
            document.getElementById('searchSection').classList.remove('hidden');
            document.getElementById('courseSelection').classList.add('hidden');
            document.getElementById('studentsSection').classList.add('hidden');
            loadAllStudentsForSearch();
            performSearch();
        }

        // Load students
        async function loadStudents() {
            const studentsList = document.getElementById('studentsList');
            studentsList.innerHTML = '<div class="col-span-full text-center py-8"><div class="loading-spinner mx-auto mb-4"></div><p class="text-gray-600">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p></div>';

            try {
                const result = await readStudents(currentCourse);
                if (result.success) {
                    displayStudents(result.data || []);
                    if (result.offline) {
                        showMessage('error', '‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå');
                    }
                } else {
                    throw new Error(result.error || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ');
                }
            } catch (error) {
                console.error('Load students error:', error);
                displayStudents([]);
                showMessage('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
            }
        }

        async function loadAllStudentsForSearch() {
            allStudentsData = [];
            const courses = ['‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£', '‡∏ô‡∏≤‡∏¢‡∏ó‡∏´‡∏≤‡∏£‡∏≠‡∏≤‡∏ß‡∏∏‡πÇ‡∏™ ‡∏ö‡∏Å.‡∏ó‡∏ó.', '‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡πà‡∏ß‡∏°'];
            
            for (const course of courses) {
                try {
                    const result = await readStudents(course);
                    if (result.success && result.data) {
                        const studentsWithCourse = result.data.map(student => ({
                            ...student,
                            course: course
                        }));
                        allStudentsData = allStudentsData.concat(studentsWithCourse);
                    }
                } catch (error) {
                    console.error(`Error loading ${course}:`, error);
                }
            }
        }

        async function updateCourseCounts() {
            const courses = ['‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£', '‡∏ô‡∏≤‡∏¢‡∏ó‡∏´‡∏≤‡∏£‡∏≠‡∏≤‡∏ß‡∏∏‡πÇ‡∏™ ‡∏ö‡∏Å.‡∏ó‡∏ó.', '‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡πà‡∏ß‡∏°'];
            
            for (const course of courses) {
                const countElement = document.getElementById(`count-${course}`);
                if (countElement) {
                    try {
                        const result = await readStudents(course);
                        const count = result.success && result.data ? result.data.length : 0;
                        countElement.textContent = `${count} ‡∏Ñ‡∏ô`;
                    } catch (error) {
                        countElement.textContent = '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î';
                    }
                }
            }
        }

        function displayStudents(students) {
            const studentsList = document.getElementById('studentsList');
            
            if (students.length === 0) {
                studentsList.innerHTML = `
                    <div class="col-span-full text-center py-8 text-gray-500">
                        <i class="fas fa-users text-4xl mb-4"></i>
                        <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÉ‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ô‡∏µ‡πâ</p>
                    </div>
                `;
                return;
            }

            studentsList.innerHTML = students.map(student => createStudentCard(student)).join('');
        }

        function createStudentCard(student) {
            const courseColors = {
                '‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏´‡∏≤‡∏£': 'border-blue-200 bg-gradient-to-br from-blue-50 to-white',
                '‡∏ô‡∏≤‡∏¢‡∏ó‡∏´‡∏≤‡∏£‡∏≠‡∏≤‡∏ß‡∏∏‡πÇ‡∏™ ‡∏ö‡∏Å.‡∏ó‡∏ó.': 'border-green-200 bg-gradient-to-br from-green-50 to-white',
                '‡πÄ‡∏™‡∏ô‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡πà‡∏ß‡∏°': 'border-purple-200 bg-gradient-to-br from-purple-50 to-white'
            };

            const cardClass = courseColors[student.course] || 'border-gray-200 bg-gradient-to-br from-gray-50 to-white';

            const adminButtons = isAdminLoggedIn ? `
                <div class="flex space-x-2 mt-4">
                    <button onclick="deleteStudentById('${student.id}', '${student.course}')" 
                            class="flex-1 bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded-lg text-sm transition-colors">
                        <i class="fas fa-trash mr-1"></i>‡∏•‡∏ö
                    </button>
                </div>
            ` : '';

            const photoElement = student.photoBase64 ? 
                `<img src="${student.photoBase64}" alt="${student.fullName}" class="student-photo mx-auto">` :
                `<div class="photo-placeholder mx-auto">
                    <i class="fas fa-user text-gray-400 text-xl"></i>
                </div>`;

            return `
                <div class="student-card rounded-xl shadow-md hover:shadow-lg p-6 border ${cardClass}">
                    <div class="text-center mb-4">
                        ${photoElement}
                    </div>
                    <div class="space-y-2">
                        <h3 class="font-semibold text-lg text-gray-800 text-center">${student.fullName}</h3>
                        ${student.nickname ? `<p class="text-gray-600 text-center text-sm"><i class="fas fa-smile mr-1"></i>${student.nickname}</p>` : ''}
                        ${student.position ? `<p class="text-gray-600 text-sm"><i class="fas fa-briefcase mr-2"></i>${student.position}</p>` : ''}
                        ${student.phone ? `<p class="text-gray-600 text-sm"><i class="fas fa-phone mr-2"></i><a href="tel:${student.phone}" class="text-blue-600 hover:text-blue-800">${student.phone}</a></p>` : ''}
                        ${student.birthDate ? `<p class="text-gray-600 text-sm"><i class="fas fa-birthday-cake mr-2"></i>${formatDate(student.birthDate)}</p>` : ''}
                    </div>
                    ${adminButtons}
                </div>
            `;
        }

        // Search functionality
        function performSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            
            let studentsToSearch = currentSearchFilter ? 
                allStudentsData.filter(student => student.course === currentSearchFilter) : 
                allStudentsData;
            
            if (searchTerm) {
                filteredStudents = studentsToSearch.filter(student => {
                    return (
                        (student.fullName && student.fullName.toLowerCase().includes(searchTerm)) ||
                        (student.nickname && student.nickname.toLowerCase().includes(searchTerm)) ||
                        (student.position && student.position.toLowerCase().includes(searchTerm)) ||
                        (student.phone && student.phone.includes(searchTerm))
                    );
                });
            } else {
                filteredStudents = studentsToSearch;
            }
            
            displaySearchResults(filteredStudents, searchTerm);
        }

        function filterByCourse(course) {
            currentSearchFilter = course;
            
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.className = 'filter-btn bg-gray-200 text-gray-700 px-3 py-1 rounded-full text-sm hover:bg-purple-100 transition-colors';
            });
            
            event.target.className = 'filter-btn bg-purple-600 text-white px-3 py-1 rounded-full text-sm transition-colors';
            performSearch();
        }

        function displaySearchResults(students, searchTerm = '') {
            const resultsContainer = document.getElementById('searchResults');
            
            if (students.length === 0) {
                resultsContainer.innerHTML = `
                    <div class="col-span-full text-center py-8 text-gray-500">
                        <i class="fas fa-search text-4xl mb-4"></i>
                        <p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
                    </div>
                `;
                return;
            }
            
            resultsContainer.innerHTML = students.map(student => createStudentCard(student)).join('');
        }

        // File handling
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
                reader.readAsDataURL(file);
            });
        }

        // Photo preview with advanced compression
        document.getElementById('photo').addEventListener('change', async function(e) {
            const file = e.target.files[0];
            const preview = document.getElementById('photoPreview');
            
            if (file) {
                try {
                    // Show loading state
                    preview.innerHTML = `
                        <div class="photo-preview bg-gray-100 flex items-center justify-center">
                            <div class="text-center">
                                <div class="loading-spinner mx-auto mb-2"></div>
                                <p class="text-xs text-gray-600">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...</p>
                            </div>
                        </div>
                    `;

                    // Validate and process image
                    const result = await validateAndProcessImage(file);
                    
                    // Show preview with compression info
                    const compressionRatio = ((result.originalSize - result.compressedSize) / result.originalSize * 100).toFixed(1);
                    
                    preview.innerHTML = `
                        <div class="space-y-2">
                            <img src="${result.base64}" class="photo-preview">
                            <div class="text-xs text-gray-600 bg-gray-50 p-2 rounded">
                                <div>‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö: ${(result.originalSize / 1024).toFixed(1)} KB</div>
                                <div>‡∏Ç‡∏ô‡∏≤‡∏î‡∏´‡∏•‡∏±‡∏á‡∏ö‡∏µ‡∏ö‡∏≠‡∏±‡∏î: ${(result.compressedSize / 1024).toFixed(1)} KB</div>
                                <div class="text-green-600">‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: ${compressionRatio}%</div>
                            </div>
                        </div>
                    `;
                    
                    // Store processed image data
                    e.target.processedImage = result;
                    
                } catch (error) {
                    console.error('Photo processing error:', error);
                    showMessage('error', error.message || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û');
                    e.target.value = '';
                    preview.innerHTML = '';
                }
            } else {
                preview.innerHTML = '';
                delete e.target.processedImage;
            }
        });

        // Add student
        document.getElementById('studentForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const selectedCourse = document.getElementById('studentCourse').value;
            if (!selectedCourse) {
                showMessage('error', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£');
                return;
            }

            const submitBtn = document.getElementById('submitBtn');
            const submitSpinner = document.getElementById('submitSpinner');
            const submitText = document.getElementById('submitText');
            
            submitBtn.disabled = true;
            submitSpinner.classList.remove('hidden');
            submitText.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';

            try {
                let photoBase64 = '';
                const photoInput = document.getElementById('photo');
                
                if (photoInput.processedImage) {
                    photoBase64 = photoInput.processedImage.base64;
                }

                const studentData = {
                    course: selectedCourse,
                    fullName: document.getElementById('fullName').value,
                    nickname: document.getElementById('nickname').value,
                    position: document.getElementById('position').value,
                    phone: document.getElementById('phone').value,
                    birthDate: document.getElementById('birthDate').value,
                    photoBase64: photoBase64
                };

                const result = await createStudent(studentData);

                if (result.success) {
                    let message = result.message || '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!';
                    if (result.offline) {
                        message += ' (‡πÇ‡∏´‡∏°‡∏î‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå)';
                    }
                    showMessage('success', message);
                    
                    document.getElementById('studentForm').reset();
                    document.getElementById('photoPreview').innerHTML = '';
                    toggleAddForm();
                    await updateCourseCounts();
                    
                    if (currentCourse === selectedCourse) {
                        await loadStudents();
                    }
                } else {
                    throw new Error(result.error || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
                }
            } catch (error) {
                console.error('Submit error:', error);
                showMessage('error', error.message || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
            } finally {
                submitBtn.disabled = false;
                submitSpinner.classList.add('hidden');
                submitText.textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
            }
        });

        // Delete student
        async function deleteStudentById(studentId, course) {
            if (!isAdminLoggedIn) {
                showMessage('error', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô');
                return;
            }
            
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ô‡∏µ‡πâ?')) {
                try {
                    const result = await deleteStudent(studentId, course);
                    
                    if (result.success) {
                        let message = result.message || '‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!';
                        if (result.offline) {
                            message += ' (‡πÇ‡∏´‡∏°‡∏î‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå)';
                        }
                        showMessage('success', message);
                        
                        await updateCourseCounts();
                        
                        if (currentCourse === course) {
                            await loadStudents();
                        }
                        
                        await loadAllStudentsForSearch();
                        performSearch();
                    } else {
                        throw new Error(result.error || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
                    }
                } catch (error) {
                    console.error('Delete error:', error);
                    showMessage('error', error.message || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
                }
            }
        }

        // Update course counts
        function updateCourseCounts() {
            Object.keys(studentsData).forEach(course => {
                const countElement = document.getElementById(`count-${course}`);
                if (countElement) {
                    const count = studentsData[course].length;
                    countElement.textContent = `${count} ‡∏Ñ‡∏ô`;
                }
            });
        }

        // Event listeners
        document.getElementById('adminLoginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const password = document.getElementById('adminPassword').value;
            loginAdmin(password);
        });

        document.getElementById('searchInput').addEventListener('input', performSearch);
        
        document.getElementById('importCSV').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                importFromCSV(file);
                e.target.value = ''; // Reset file input
            }
        });

        // Export to CSV function
        function exportToCSV() {
            if (!isAdminLoggedIn) {
                showMessage('error', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô');
                return;
            }

            try {
                let csvContent = '‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£,‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á,‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô,‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á,‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£,‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î\n';
                
                Object.keys(studentsData).forEach(course => {
                    studentsData[course].forEach(student => {
                        const row = [
                            course,
                            student.fullName || '',
                            student.nickname || '',
                            student.position || '',
                            student.phone || '',
                            student.birthDate || ''
                        ].map(field => `"${field.replace(/"/g, '""')}"`).join(',');
                        csvContent += row + '\n';
                    });
                });

                const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', `‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤_${new Date().toISOString().split('T')[0]}.csv`);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                showMessage('success', '‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CSV ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
            } catch (error) {
                console.error('Export error:', error);
                showMessage('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
            }
        }

        // Import from CSV function
        function importFromCSV(file) {
            if (!isAdminLoggedIn) {
                showMessage('error', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const csv = e.target.result;
                    const lines = csv.split('\n');
                    let importCount = 0;
                    
                    // Skip header row
                    for (let i = 1; i < lines.length; i++) {
                        const line = lines[i].trim();
                        if (!line) continue;
                        
                        // Parse CSV line (handle quoted fields)
                        const fields = [];
                        let current = '';
                        let inQuotes = false;
                        
                        for (let j = 0; j < line.length; j++) {
                            const char = line[j];
                            if (char === '"') {
                                inQuotes = !inQuotes;
                            } else if (char === ',' && !inQuotes) {
                                fields.push(current.replace(/^"|"$/g, '').replace(/""/g, '"'));
                                current = '';
                            } else {
                                current += char;
                            }
                        }
                        fields.push(current.replace(/^"|"$/g, '').replace(/""/g, '"'));
                        
                        if (fields.length >= 2) {
                            const [course, fullName, nickname, position, phone, birthDate] = fields;
                            
                            if (course && fullName) {
                                const newStudent = {
                                    id: generateId(),
                                    course: course,
                                    fullName: fullName,
                                    nickname: nickname || '',
                                    position: position || '',
                                    phone: phone || '',
                                    birthDate: birthDate || '',
                                    photoBase64: ''
                                };
                                
                                if (!studentsData[course]) {
                                    studentsData[course] = [];
                                }
                                
                                studentsData[course].push(newStudent);
                                importCount++;
                            }
                        }
                    }
                    
                    if (importCount > 0) {
                        saveToLocalStorage();
                        updateCourseCounts();
                        showMessage('success', `‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ${importCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!`);
                        
                        // Refresh current view if needed
                        if (currentCourse) {
                            loadStudents();
                        }
                    } else {
                        showMessage('error', '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå CSV');
                    }
                } catch (error) {
                    console.error('Import error:', error);
                    showMessage('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
                }
            };
            
            reader.readAsText(file, 'UTF-8');
        }

        // Backup management functions
        function showBackupManager() {
            if (!isAdminLoggedIn) {
                showMessage('error', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô');
                return;
            }
            
            document.getElementById('backupManagerModal').classList.remove('hidden');
            updateBackupStatus();
            loadBackupList();
        }

        function closeBackupManager() {
            document.getElementById('backupManagerModal').classList.add('hidden');
        }

        function updateBackupStatus() {
            const statusEl = document.getElementById('backupStatus');
            const lastSaved = localStorage.getItem('lastSaved');
            const backupKeys = Object.keys(localStorage).filter(key => key.startsWith('backup_'));
            
            let statusHTML = '';
            if (lastSaved) {
                const lastSavedDate = new Date(lastSaved);
                statusHTML += `<div>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${lastSavedDate.toLocaleString('th-TH')}</div>`;
            }
            
            statusHTML += `<div>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏£‡∏≠‡∏á: ${backupKeys.length} ‡πÑ‡∏ü‡∏•‡πå</div>`;
            
            if (isOnlineMode && lastSyncTime) {
                statusHTML += `<div>‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${lastSyncTime.toLocaleString('th-TH')}</div>`;
            }
            
            statusEl.innerHTML = statusHTML;
        }

        function loadBackupList() {
            const listEl = document.getElementById('backupList');
            const backupKeys = Object.keys(localStorage).filter(key => key.startsWith('backup_'));
            
            if (backupKeys.length === 0) {
                listEl.innerHTML = '<div class="text-gray-500 text-sm">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</div>';
                return;
            }
            
            backupKeys.sort().reverse(); // Most recent first
            
            const backupHTML = backupKeys.map(key => {
                try {
                    const backup = JSON.parse(localStorage.getItem(key));
                    const date = new Date(backup.timestamp);
                    const totalStudents = Object.values(backup.data).reduce((sum, course) => sum + course.length, 0);
                    
                    return `
                        <div class="flex justify-between items-center bg-white p-3 rounded border">
                            <div>
                                <div class="font-medium">${date.toLocaleDateString('th-TH')}</div>
                                <div class="text-sm text-gray-600">${totalStudents} ‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤ - ${date.toLocaleTimeString('th-TH')}</div>
                            </div>
                            <div class="flex space-x-2">
                                <button onclick="restoreFromSpecificBackup('${key}')" 
                                        class="bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs transition-colors">
                                    ‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô
                                </button>
                                <button onclick="deleteBackup('${key}')" 
                                        class="bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs transition-colors">
                                    ‡∏•‡∏ö
                                </button>
                            </div>
                        </div>
                    `;
                } catch (error) {
                    return '';
                }
            }).join('');
            
            listEl.innerHTML = backupHTML;
        }

        function createManualBackup() {
            try {
                createAutoBackup();
                showMessage('success', '‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                updateBackupStatus();
                loadBackupList();
            } catch (error) {
                showMessage('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏£‡∏≠‡∏á');
            }
        }

        function downloadBackup() {
            try {
                const backupData = {
                    timestamp: new Date().toISOString(),
                    data: studentsData,
                    version: '1.0'
                };
                
                const blob = new Blob([JSON.stringify(backupData, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏£‡∏≠‡∏á_${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                URL.revokeObjectURL(url);
                
                showMessage('success', '‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
            } catch (error) {
                showMessage('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î');
            }
        }

        function restoreFromSpecificBackup(backupKey) {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏ô‡∏µ‡πâ? ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà')) {
                try {
                    const backup = JSON.parse(localStorage.getItem(backupKey));
                    studentsData = backup.data;
                    saveToLocalStorage();
                    updateCourseCounts();
                    
                    if (currentCourse) {
                        loadStudents();
                    }
                    
                    showMessage('success', '‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                    closeBackupManager();
                } catch (error) {
                    showMessage('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
                }
            }
        }

        function deleteBackup(backupKey) {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏ô‡∏µ‡πâ?')) {
                try {
                    localStorage.removeItem(backupKey);
                    showMessage('success', '‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                    updateBackupStatus();
                    loadBackupList();
                } catch (error) {
                    showMessage('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏£‡∏≠‡∏á');
                }
            }
        }

        // GitHub setup functions
        function showGitHubSetup() {
            if (!isAdminLoggedIn) {
                showMessage('error', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô');
                return;
            }
            
            // Pre-fill existing values if available
            if (GITHUB_CONFIG.username !== 'YOUR_GITHUB_USERNAME') {
                document.getElementById('githubUsername').value = GITHUB_CONFIG.username;
            }
            document.getElementById('githubRepo').value = GITHUB_CONFIG.repository;
            
            document.getElementById('githubSetupModal').classList.remove('hidden');
        }

        function closeGitHubSetup() {
            document.getElementById('githubSetupModal').classList.add('hidden');
            document.getElementById('githubSetupForm').reset();
        }

        async function setupGitHub(username, repository, token) {
            try {
                // Update configuration
                GITHUB_CONFIG.username = username;
                GITHUB_CONFIG.repository = repository;
                
                // Store token securely
                githubToken = token;
                localStorage.setItem('github_token', token);
                localStorage.setItem('github_config', JSON.stringify(GITHUB_CONFIG));
                
                // Test connection
                await testGitHubConnection();
                
                // Enable GitHub mode
                isGitHubMode = true;
                updateConnectionStatus('github');
                
                // Initial sync
                await syncWithGitHub();
                
                showMessage('success', 'üéâ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ GitHub Pages ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå');
                closeGitHubSetup();
                
                // Start auto sync
                startAutoSync();
                
                return true;
            } catch (error) {
                console.error('GitHub setup error:', error);
                showMessage('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message);
                return false;
            }
        }

        async function testGitHubConnection() {
            try {
                const url = `https://api.github.com/repos/${GITHUB_CONFIG.username}/${GITHUB_CONFIG.repository}`;
                const response = await fetch(url, {
                    headers: {
                        'Authorization': `token ${githubToken}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (response.status === 404) {
                    throw new Error('Repository ‡πÑ‡∏°‡πà‡∏û‡∏ö ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á repository ‡∏Å‡πà‡∏≠‡∏ô');
                }
                
                if (!response.ok) {
                    throw new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ GitHub ‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Token');
                }
                
                return true;
            } catch (error) {
                throw new Error('‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ GitHub ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ' + error.message);
            }
        }

        // Cloud options functions
        function showCloudOptions() {
            if (!isAdminLoggedIn) {
                showMessage('error', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô');
                return;
            }
            document.getElementById('cloudOptionsModal').classList.remove('hidden');
        }

        function closeCloudOptions() {
            document.getElementById('cloudOptionsModal').classList.add('hidden');
        }

        // Event listeners for backup restore
        document.getElementById('restoreBackup').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    try {
                        const backupData = JSON.parse(event.target.result);
                        
                        if (backupData.data && confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ? ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà')) {
                            studentsData = backupData.data;
                            saveToLocalStorage();
                            updateCourseCounts();
                            
                            if (currentCourse) {
                                loadStudents();
                            }
                            
                            showMessage('success', '‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                            closeBackupManager();
                        }
                    } catch (error) {
                        showMessage('error', '‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                    }
                };
                reader.readAsText(file);
                e.target.value = ''; // Reset file input
            }
        });

        // GitHub setup form handler
        document.getElementById('githubSetupForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const username = document.getElementById('githubUsername').value.trim();
            const repository = document.getElementById('githubRepo').value.trim();
            const token = document.getElementById('githubToken').value.trim();
            
            if (!username || !repository || !token) {
                showMessage('error', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
                return;
            }
            
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...';
            
            try {
                await setupGitHub(username, repository, token);
            } catch (error) {
                console.error('GitHub setup error:', error);
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                loadFromLocalStorage();
                
                // Load GitHub configuration if available
                const savedConfig = localStorage.getItem('github_config');
                if (savedConfig) {
                    const config = JSON.parse(savedConfig);
                    Object.assign(GITHUB_CONFIG, config);
                }
                
                // Initialize cloud storage system
                const cloudEnabled = initializeCloudStorage();
                
                if (cloudEnabled && isGitHubMode) {
                    updateConnectionStatus('github');
                    
                    // Initial sync from GitHub
                    try {
                        await syncWithGitHub();
                        console.log('üåü GitHub Pages mode - ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô!');
                    } catch (error) {
                        console.error('Initial GitHub sync failed:', error);
                        showMessage('error', '‡∏ã‡∏¥‡∏á‡∏Ñ‡πå GitHub ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß - ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå');
                    }
                    
                    // Start auto sync
                    startAutoSync();
                } else {
                    updateConnectionStatus('local');
                    console.log('üì± Local storage mode - ‡∏≠‡∏±‡∏õ‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏õ‡πá‡∏ô GitHub Pages ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô');
                }
                
                await updateCourseCounts();
                
                // Start auto backup
                autoBackupInterval = setInterval(() => {
                    createAutoBackup();
                }, 300000); // Auto backup every 5 minutes
                
                console.log('‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                
            } catch (error) {
                console.error('Initialization error:', error);
                updateConnectionStatus('local');
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9815d95ac2e9893a',t:'MTc1ODI1MDk5Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
